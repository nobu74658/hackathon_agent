# 新人営業マン成長支援AIエージェント 運用マニュアル

## 1. システム概要

### 1.1 目的
本システムは、新人営業マンの成長を支援するためのAIエージェントシステムです。1on1ミーティングの内容を分析し、具体的なアクションプランを生成することで、営業スキルの向上を促進します。

### 1.2 対象ユーザー
- **新人営業マン**: システムの主要利用者
- **マネージャー**: 1on1実施者、進捗確認者
- **システム管理者**: システム運用・保守担当者

## 2. 運用体制

### 2.1 運用組織
```
運用責任者
├── システム管理チーム（3名）
│   ├── インフラ担当
│   ├── アプリケーション担当
│   └── セキュリティ担当
├── サポートチーム（2名）
│   ├── ユーザーサポート担当
│   └── 技術サポート担当
└── AI運用チーム（2名）
    ├── モデル管理担当
    └── データ分析担当
```

### 2.2 役割と責任
| 役割 | 責任範囲 |
|------|----------|
| 運用責任者 | 全体統括、インシデント最終判断、経営報告 |
| インフラ担当 | AWS環境管理、監視、バックアップ |
| アプリケーション担当 | アプリケーション保守、デプロイ管理 |
| セキュリティ担当 | セキュリティ監視、脆弱性対応 |
| ユーザーサポート | 問い合わせ対応、マニュアル更新 |
| AI運用担当 | LLMモデル管理、精度監視 |

## 3. 日常運用

### 3.1 日次作業

#### 3.1.1 システムチェック（9:00）
```bash
# ヘルスチェック
curl https://api.sales-growth-ai.com/health

# 各サービスの稼働確認
kubectl get pods -n production
kubectl get services -n production

# ログ確認
aws logs tail /aws/ecs/sales-growth-api --follow
```

#### 3.1.2 監視ダッシュボード確認（9:30）
- CloudWatch ダッシュボード
  - CPU/メモリ使用率
  - API レスポンスタイム
  - エラー率
- Datadog APM
  - トランザクション追跡
  - 遅延の原因分析

#### 3.1.3 バックアップ確認（10:00）
```bash
# RDS自動バックアップ確認
aws rds describe-db-snapshots --db-instance-identifier prod-db

# S3バックアップ確認
aws s3 ls s3://sales-growth-backups/daily/
```

### 3.2 週次作業

#### 3.2.1 パフォーマンスレビュー（月曜 14:00）
- 週間レスポンスタイム分析
- API使用状況レポート作成
- リソース使用傾向分析

#### 3.2.2 セキュリティスキャン（水曜 10:00）
```bash
# 脆弱性スキャン実行
trivy image sales-growth-api:latest

# 依存関係の脆弱性チェック
npm audit
pip-audit
```

#### 3.2.3 ユーザーフィードバック集計（金曜 16:00）
- サポートチケット分析
- 改善要望の優先順位付け
- FAQ更新

### 3.3 月次作業

#### 3.3.1 定期メンテナンス（第3日曜日 2:00-4:00）
1. メンテナンス告知（1週間前）
2. バックアップ実行
3. システムアップデート
   ```bash
   # ECSタスク定義更新
   aws ecs update-service --cluster prod-cluster --service api-service --task-definition api:latest
   
   # RDSマイナーバージョンアップグレード
   aws rds modify-db-instance --db-instance-identifier prod-db --apply-immediately
   ```
4. 動作確認
5. メンテナンス完了通知

#### 3.3.2 容量計画レビュー
- ストレージ使用状況確認
- トラフィック成長率分析
- スケーリング計画更新

## 4. 監視・アラート

### 4.1 監視項目と閾値

| 監視項目 | 警告閾値 | エラー閾値 | 対応 |
|---------|----------|-----------|------|
| API応答時間 | 1秒 | 3秒 | スケールアウト検討 |
| CPU使用率 | 70% | 85% | インスタンス追加 |
| メモリ使用率 | 75% | 90% | メモリリーク調査 |
| エラー率 | 1% | 5% | ログ分析、原因調査 |
| DB接続数 | 80% | 95% | コネクションプール調整 |

### 4.2 アラート設定
```yaml
# CloudWatch Alarm設定例
HighAPILatency:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: High-API-Latency
    MetricName: ResponseTime
    Statistic: Average
    Period: 300
    EvaluationPeriods: 2
    Threshold: 1000
    ComparisonOperator: GreaterThanThreshold
    AlarmActions:
      - !Ref SNSTopic
```

### 4.3 アラート対応フロー
```
アラート発生
    ↓
初期対応（15分以内）
    ├─ 影響範囲確認
    ├─ ログ調査
    └─ 一次対応実施
    ↓
エスカレーション判断
    ├─ 解決 → インシデント記録
    └─ 未解決 → レベル2対応
        ↓
    詳細調査・対応
        ├─ 根本原因分析
        ├─ 恒久対策実施
        └─ 再発防止策策定
```

## 5. バックアップ・リストア

### 5.1 バックアップポリシー

| 対象 | 頻度 | 保持期間 | 方式 |
|------|------|----------|------|
| RDS | 日次 | 30日 | 自動スナップショット |
| S3データ | 日次 | 90日 | クロスリージョンレプリケーション |
| アプリケーションデータ | 日次 | 7日 | S3へのエクスポート |
| 設定ファイル | 変更時 | 無期限 | Git管理 |

### 5.2 リストア手順

#### 5.2.1 RDSリストア
```bash
# スナップショットからリストア
aws rds restore-db-instance-from-db-snapshot \
  --db-instance-identifier restored-db \
  --db-snapshot-identifier snapshot-2024-01-15

# DNSの切り替え
aws route53 change-resource-record-sets \
  --hosted-zone-id Z1234567890 \
  --change-batch file://dns-change.json
```

#### 5.2.2 アプリケーションデータリストア
```bash
# S3からダウンロード
aws s3 cp s3://sales-growth-backups/app-data/2024-01-15.tar.gz .

# データ復元
tar -xzf 2024-01-15.tar.gz
python restore_script.py --data-dir ./backup-data
```

## 6. インシデント対応

### 6.1 インシデントレベル定義

| レベル | 定義 | 対応時間 | エスカレーション |
|--------|------|----------|-----------------|
| Critical | サービス全体停止 | 即時 | 30分で経営層へ |
| High | 主要機能の障害 | 30分以内 | 1時間で部門長へ |
| Medium | 一部機能の障害 | 2時間以内 | 4時間でチームリーダーへ |
| Low | 軽微な不具合 | 翌営業日 | 必要に応じて |

### 6.2 インシデント対応手順

1. **検知・記録**
   ```
   インシデント番号: INC-2024-0115-001
   発生時刻: 2024-01-15 14:30:00
   検知方法: 自動アラート / ユーザー報告
   影響範囲: 全ユーザー / 特定機能 / 特定ユーザー
   ```

2. **初期対応**
   - 影響範囲の特定
   - 暫定対処の実施
   - ステークホルダーへの連絡

3. **原因調査**
   - ログ分析
   - 再現確認
   - 根本原因の特定

4. **恒久対策**
   - 修正の実装
   - テスト実施
   - 本番適用

5. **事後対応**
   - インシデントレポート作成
   - 再発防止策の策定
   - ナレッジベース更新

### 6.3 よくあるインシデントと対処法

#### API応答遅延
```bash
# 1. 負荷状況確認
kubectl top pods
kubectl top nodes

# 2. スケールアウト
kubectl scale deployment api-deployment --replicas=5

# 3. キャッシュクリア
redis-cli FLUSHALL
```

#### データベース接続エラー
```bash
# 1. 接続数確認
SELECT count(*) FROM pg_stat_activity;

# 2. 不要な接続を切断
SELECT pg_terminate_backend(pid) 
FROM pg_stat_activity 
WHERE state = 'idle' AND state_change < now() - interval '10 minutes';

# 3. コネクションプール再起動
kubectl rollout restart deployment api-deployment
```

## 7. ユーザーサポート

### 7.1 問い合わせ対応フロー
```
問い合わせ受付
    ↓
分類・優先度設定
    ├─ 操作方法 → FAQ確認 → 回答
    ├─ 不具合報告 → 再現確認 → 開発チームへ
    └─ 機能要望 → 記録 → 定期レビューへ
```

### 7.2 よくある問い合わせ

#### Q: ログインできない
**A:** 以下を確認してください：
1. メールアドレスの入力ミス
2. パスワードの大文字小文字
3. アカウントロック（5回失敗で30分ロック）

#### Q: AI分析が終わらない
**A:** 通常5分以内に完了します。10分以上かかる場合は：
1. ページをリロード
2. 再度分析を実行
3. それでも解決しない場合はサポートへ連絡

#### Q: アクションプランが表示されない
**A:** 以下を確認してください：
1. 対話セッションが完了しているか
2. ブラウザのキャッシュをクリア
3. 別のブラウザで試す

### 7.3 ユーザートレーニング

#### 新規ユーザー向け
- オンボーディング動画（15分）
- 操作マニュアル（PDF）
- サンプルデータでの練習環境

#### 定期トレーニング
- 月次ウェビナー（新機能紹介）
- ベストプラクティス共有会
- Q&Aセッション

## 8. メンテナンス作業

### 8.1 定期メンテナンス項目

| 項目 | 頻度 | 作業内容 | 所要時間 |
|------|------|----------|----------|
| OSパッチ適用 | 月次 | セキュリティパッチ適用 | 30分 |
| DBメンテナンス | 月次 | VACUUM, ANALYZE実行 | 1時間 |
| ログローテーション | 週次 | 古いログの圧縮・移動 | 15分 |
| SSL証明書更新 | 年次 | 証明書の更新・適用 | 30分 |

### 8.2 緊急メンテナンス

#### 実施判断基準
- セキュリティ脆弱性（CVSS 7.0以上）
- データ不整合の発見
- パフォーマンス著しい劣化

#### 実施手順
1. 影響評価
2. 実施時間の決定（影響最小化）
3. 告知（最低1時間前、緊急時は即時）
4. メンテナンス実施
5. 動作確認
6. 完了通知

## 9. 性能管理

### 9.1 パフォーマンス目標

| 指標 | 目標値 | 測定方法 |
|------|--------|----------|
| ページ読み込み時間 | 2秒以内 | Google PageSpeed |
| API応答時間（p95） | 500ms以内 | Datadog APM |
| 同時接続ユーザー数 | 1,000人 | 負荷テスト |
| 可用性 | 99.5% | Uptime監視 |

### 9.2 チューニング指針

#### データベース
```sql
-- インデックス追加
CREATE INDEX idx_sessions_user_date ON one_on_one_sessions(user_id, session_date);

-- クエリ最適化
EXPLAIN ANALYZE SELECT ...;

-- パーティショニング
CREATE TABLE one_on_one_sessions_2024_01 PARTITION OF one_on_one_sessions
FOR VALUES FROM ('2024-01-01') TO ('2024-02-01');
```

#### アプリケーション
```python
# キャッシュ活用
@cache.memoize(timeout=300)
def get_user_sessions(user_id):
    return db.query(...)

# 非同期処理
async def process_analysis(session_id):
    await asyncio.gather(
        analyze_text(session_id),
        extract_keywords(session_id),
        generate_summary(session_id)
    )
```

## 10. セキュリティ運用

### 10.1 定期セキュリティ監査

#### 月次タスク
- [ ] アクセスログレビュー
- [ ] 不正アクセス試行の確認
- [ ] 権限設定の棚卸し
- [ ] 脆弱性スキャン実施

#### 四半期タスク
- [ ] ペネトレーションテスト
- [ ] セキュリティポリシー見直し
- [ ] インシデント対応訓練

### 10.2 アクセス管理

#### 権限マトリクス
| ロール | 1on1入力 | 分析結果閲覧 | 他者データ閲覧 | 管理機能 |
|--------|----------|--------------|----------------|----------|
| 新人営業 | ○ | 自分のみ | × | × |
| マネージャー | ○ | 部下のみ | 部下のみ | × |
| 管理者 | ○ | ○ | ○ | ○ |

#### アカウント管理
```bash
# 90日間未使用アカウントの抽出
SELECT email, last_login 
FROM users 
WHERE last_login < CURRENT_DATE - INTERVAL '90 days';

# アカウント無効化
UPDATE users SET is_active = false WHERE id = 'user_id';
```

## 11. 災害対策

### 11.1 BCP（事業継続計画）

#### RTOとRPO
- RTO（復旧時間目標）: 4時間
- RPO（復旧時点目標）: 24時間

#### 災害時の対応フロー
1. 災害発生の確認
2. 対策本部の設置
3. 被害状況の確認
4. 復旧優先順位の決定
5. 復旧作業の実施
6. サービス再開

### 11.2 DR（災害復旧）サイト

#### 構成
- プライマリ: 東京リージョン（ap-northeast-1）
- DR: 大阪リージョン（ap-northeast-3）
- データ同期: 非同期レプリケーション（5分間隔）

#### 切り替え手順
```bash
# 1. DRサイトの起動
terraform apply -var="environment=dr"

# 2. データベースのフェイルオーバー
aws rds promote-read-replica --db-instance-identifier dr-db

# 3. DNS切り替え
aws route53 change-resource-record-sets --hosted-zone-id Z123 --change-batch file://dr-failover.json
```

## 12. 改善活動

### 12.1 KPI監視

| KPI | 目標 | 測定頻度 | 改善アクション |
|-----|------|----------|--------------|
| 平均応答時間 | 500ms以下 | 日次 | キャッシュ最適化 |
| エラー率 | 0.1%以下 | リアルタイム | エラー分析と修正 |
| ユーザー満足度 | 4.0以上 | 月次 | UI/UX改善 |
| AI精度 | 85%以上 | 週次 | モデル再学習 |

### 12.2 定期レビュー

#### 月次運用レビュー
- インシデント分析
- パフォーマンストレンド
- コスト最適化
- 改善提案

#### 四半期サービスレビュー
- ユーザーフィードバック分析
- 機能利用状況
- ロードマップ見直し
- 投資対効果評価

## 13. ドキュメント管理

### 13.1 ドキュメント一覧

| ドキュメント | 更新頻度 | 管理者 | 保管場所 |
|------------|----------|--------|----------|
| 運用マニュアル | 変更時 | 運用チーム | Confluence |
| API仕様書 | リリース時 | 開発チーム | GitLab |
| ユーザーマニュアル | 機能追加時 | サポートチーム | 公開サイト |
| 障害対応手順書 | 随時 | 運用チーム | Confluence |

### 13.2 変更管理

#### 変更管理プロセス
1. 変更要求（RFC）の作成
2. 影響評価
3. 承認プロセス
4. 実施計画策定
5. 実施
6. 事後評価

## 14. 連絡先

### 14.1 緊急連絡先

| 担当 | 氏名 | 電話番号 | メール |
|------|------|----------|--------|
| 運用責任者 | 山田太郎 | 090-XXXX-XXXX | yamada@example.com |
| インフラ担当 | 鈴木一郎 | 090-XXXX-XXXX | suzuki@example.com |
| セキュリティ担当 | 佐藤花子 | 090-XXXX-XXXX | sato@example.com |

### 14.2 エスカレーション

```
Level 1: 運用担当者（24/365対応）
    ↓ 30分
Level 2: チームリーダー
    ↓ 1時間
Level 3: 運用責任者
    ↓ 2時間
Level 4: 事業部長
```

### 14.3 外部ベンダー連絡先

| ベンダー | サービス | 連絡先 | 契約番号 |
|---------|---------|--------|----------|
| AWS | クラウドインフラ | support@aws.com | 12345678 |
| OpenAI | LLM API | support@openai.com | OAI-2024-001 |
| Datadog | 監視 | support@datadog.com | DD-2024-123 |