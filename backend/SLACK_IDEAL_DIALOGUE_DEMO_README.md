# Slack理想的対話デモ - 使用ガイド

## 概要

`slack_ideal_dialogue_demo.py` は、新人営業マンとAIエージェントの理想的な対話をSlack上で再現するデモスクリプトです。このデモでは、実際のSlack DMを使用して、ユーザーの入力を待ちながら段階的に対話を進めていきます。

## デモの特徴

### 1. インタラクティブな対話
- コンソールからユーザーの回答を入力
- 入力内容がリアルタイムでSlackに反映
- AIの応答もSlack上に表示

### 2. 知識ベース活用
- 過去の会話履歴を参照
- 社内ベストプラクティスを活用
- 自己解決による質問数の削減

### 3. 具体的なアウトプット
- テンプレート付きアクションプラン
- 優先度付きタスクリスト
- 先輩からのアドバイス

## セットアップ手順

### 1. 環境変数の設定

`.env` ファイルに以下を追加：

```bash
# Slack Bot Token（必須）
SLACK_BOT_TOKEN=xoxb-your-bot-token-here

# その他の設定
USE_MOCK_LLM=false
OPENAI_API_KEY=your-openai-api-key
# または
ANTHROPIC_API_KEY=your-anthropic-api-key
```

### 2. 必要なパッケージのインストール

```bash
cd backend
pip install slack-sdk aiohttp
```

### 3. APIサーバーの起動

別のターミナルで：

```bash
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. Slack Appの権限確認

Slack Appに以下の権限が必要です：
- `chat:write` - メッセージ送信
- `im:write` - DM作成
- `im:read` - DM読み取り
- `users:read` - ユーザー情報取得

## デモの実行

```bash
cd backend
python slack_ideal_dialogue_demo.py
```

## デモの流れ

### 1. 開始確認
```
📋 環境設定チェック:
✅ SLACK_BOT_TOKEN: 設定済み
✅ APIサーバー: 接続成功

デモを開始しますか？ (y/n): y
```

### 2. 初期メッセージ
Slackに以下のようなメッセージが投稿されます：
```
🤖 Sales Growth AI Agent

こんにちは、山田太郎さん！営業スキル向上のお手伝いをさせていただきます。

過去の会話履歴と社内のベストプラクティスを参考に、
山田さんに最適なサポートを提供いたします。
```

### 3. 質問への回答
コンソールで質問への回答を入力：
```
💭 質問1への回答を入力してください
👤 ユーザーの応答を入力してください（Enterで送信）: 
> 新規顧客へのアプローチがうまくいきません
```

### 4. 対話の継続
- 情報充足度が表示される
- 知識ベースから自動解決された情報が表示される
- 必要に応じて追加質問が生成される

### 5. アクションプラン生成
十分な情報が集まると、具体的なアクションプランが生成されます：
```
🎯 アクションプラン完成！

📋 概要: 新規顧客開拓スキル向上のための段階的プラン

📑 すぐに使えるテンプレート
• 初回アプローチメールテンプレート（新規開拓）
• 電話スクリプトテンプレート（アポイント獲得）

📈 具体的なアクション

🔴 1. ターゲット顧客リストの作成
   理想的な顧客プロファイルを定義し、リストを作成
   📅 期限: 1週間以内

🟡 2. アプローチ手法の多様化
   メール、電話、LinkedInなど複数チャネルを活用
   📅 期限: 2週間以内
```

## サンプル回答例

デモをスムーズに進めるための回答例：

1. **初回質問への回答**
   - 「新規顧客へのアプローチがうまくいきません」
   - 「商談でのクロージングが苦手です」
   - 「プレゼンで緊張してしまいます」

2. **追加質問への回答**
   - 「主に電話でアプローチしていますが、断られることが多いです」
   - 「月に10件の新規獲得が目標ですが、現在は3件程度です」
   - 「製品の説明はできますが、価値提案がうまくできません」

3. **具体的な状況説明**
   - 「中小企業の製造業をターゲットにしています」
   - 「営業経験は1年で、主に既存顧客のフォローをしていました」
   - 「上司からはもっと積極的にアプローチするよう言われています」

## トラブルシューティング

### Slack接続エラー
```
❌ Slack APIエラー: invalid_auth
```
→ `SLACK_BOT_TOKEN` が正しく設定されているか確認

### APIサーバー接続エラー
```
❌ APIサーバーに接続できません
```
→ APIサーバーが起動しているか確認（`uvicorn app.main:app --reload`）

### 権限エラー
```
❌ メッセージ送信エラー: missing_scope
```
→ Slack Appに必要な権限が付与されているか確認

## 終了方法

対話中に以下のいずれかを入力：
- `quit`
- `exit`
- `終了`

## カスタマイズ

### 初期設定の変更

`slack_ideal_dialogue_demo.py` の以下の部分を編集：

```python
request_data = {
    "user_name": "山田太郎",  # ユーザー名を変更
    "department": "営業部",     # 部署を変更
    "experience_years": 1,      # 経験年数を変更
    "initial_topic": "営業スキル向上",
    "specific_challenge": "新規顧客開拓と商談スキル"  # 課題を変更
}
```

### 対話回数の変更

```python
max_conversations = 5  # この値を変更して対話回数を調整
```

## 注意事項

- このデモはSlackの実際のDMを使用します
- メッセージはSlackワークスペースに保存されます
- デモ実行前に適切な権限が設定されていることを確認してください
- 本番環境では使用しないでください（デモ専用）